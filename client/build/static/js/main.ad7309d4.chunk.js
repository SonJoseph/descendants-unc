(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{105:function(e,t,a){e.exports=a(155)},110:function(e,t,a){},116:function(e,t,a){},146:function(e,t){},151:function(e,t,a){},155:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(9),o=a.n(s),i=(a(110),a(14)),c=a(16),l=a.n(c),u=a(24),d=a(8),m=a(6),p=a(10),h=a(11),f=a(12),b=a(192),v=a(64),g=a(34),E=a(191),j=a(198),y=a(197),O=a(189),k=a(195),w=a(187),x=a(190),C=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).update=function(e){a.props.updateDocument(a.idx,e.target.name,e.target.value)},a.delete=function(){a.props.deleteDocument(a.idx)},a.idx=a.props.idx,a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(j.a,{label:"Document Name",name:"name",onChange:this.update,defaultValue:this.props.initName}),r.a.createElement(j.a,{label:"Document Link",name:"link",onChange:this.update,defaultValue:this.props.initLink}))}}]),t}(r.a.Component),I=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).update=function(e){a.setState({reln:e.target.value}),a.props.updateRelnForm(e.target.value)},console.log("Is the selected node the root of the tree?: "+a.props.selectedIsRoot),a.state={reln:""},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"What is ",this.props.name,"'s relationship to ",this.props.selectedName,"? "),r.a.createElement(k.a,{name:"relnType",onChange:this.update,value:this.state.reln},r.a.createElement(O.a,{value:"spouse"},"Spouse"),r.a.createElement(O.a,{value:"parent"},"Child"),this.props.selectedIsRoot&&r.a.createElement(O.a,{value:"child"},"Parent")))}}]),t}(r.a.Component),D=(a(116),function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).updateRootInfo=function(e){a.setState(Object(i.a)({},e.target.name,e.target.value))},a.addDocument=function(){a.state.documents.push({name:"",link:""}),a.setState({documents:a.state.documents})},a.deleteLastDocument=function(){a.state.documents.splice(a.state.documents.length-1,1),a.setState({documents:a.state.documents})},a.updateDocument=function(e,t,n){a.state.documents[e][t]=n},a.updateRelnForm=function(e){a.state.relnType=e},a.create=Object(u.a)(l.a.mark((function e(){var t,n,r,s,o,i,c,u,d,m;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.state.name){e.next=2;break}return e.abrupt("return");case 2:if(t={name:a.state.name,gender:a.state.gender,birth:a.state.birth,death:a.state.death,documents:a.state.documents,moreinfo:a.state.moreinfo},a.props.isUpdate){e.next=47;break}return n="child"===a.state.relnType,(a.state.isRoot||n)&&(t.root=1),r="/api/createnode/person="+JSON.stringify(t),e.next=9,fetch(r);case 9:return s=e.sent,e.next=12,s.json();case 12:if(o=e.sent,a.state.isRoot){e.next=44;break}if(i="undefined",n){e.next=34;break}return e.next=18,fetch("/api/getspouseid/nodeid="+a.props.selectedID);case 18:return c=e.sent,e.next=21,c.json();case 21:return u=e.sent,i=u.spouseId,r="/api/createrelationship/newId="+o.id+"&relnId="+a.props.selectedID+"&relnType="+a.state.relnType+"&spouseId="+i,e.next=26,fetch(r);case 26:return d=e.sent,e.next=29,d.json();case 29:return e.sent,a.props.back(!1,o.id),e.abrupt("return");case 34:return r="/api/createrelationship/newId="+a.props.selectedID+"&relnId="+o.id+"&relnType=parent&spouseId="+i,e.next=37,fetch(r);case 37:return m=e.sent,e.next=40,m.json();case 40:e.sent,a.props.changeRoot(o.id);case 42:e.next=45;break;case 44:a.props.history.push({pathname:"/update",state:{family:o}});case 45:e.next=49;break;case 47:t.id=a.props.selectedJson.id,a.props.updateNode(t);case 49:case"end":return e.stop()}}),e)}))),a.state={name:a.props.isUpdate?a.props.selectedJson.name:"",gender:a.props.isUpdate?a.props.selectedJson.gender:"",birth:a.props.isUpdate?a.props.selectedJson.birth:"",death:a.props.isUpdate?a.props.selectedJson.death:"",moreinfo:a.props.isUpdate?a.props.selectedJson.moreinfo:"",isRoot:a.props.isRoot,documents:a.props.isUpdate?a.props.selectedJson.documents:[{name:"",link:""}],relnType:""},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){for(var e=[],t=0;t<this.state.documents.length;t++)console.log(this.state.documents[t].name+" : "+this.state.documents[t].link),e.push(r.a.createElement(C,{idx:t,initName:this.state.documents[t].name,initLink:this.state.documents[t].link,updateDocument:this.updateDocument}));return r.a.createElement("div",null,r.a.createElement(x.a,{container:!0,spacing:2,direction:"column",justify:"center",alignItems:"center",style:{maxHeight:"100%",overflow:"auto"}},this.props.isUpdate&&r.a.createElement("h2",null,"Editing ",this.state.name),!this.props.isUpdate&&!this.props.isRoot&&r.a.createElement("h2",null,"Adding Relative to ",this.props.selectedJson.name),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(x.a,{container:!0,spacing:2,direction:"row"},r.a.createElement(x.a,{item:!0},r.a.createElement(j.a,{label:"Name",name:"name",onChange:this.updateRootInfo,defaultValue:this.state.name,error:""===this.state.name,helperText:""===this.state.name?"Name Field Required":" "})),r.a.createElement(x.a,{item:!0},r.a.createElement(w.a,{className:"formControl"},r.a.createElement(y.a,{id:"demo-mutiple-name-label"},"Gender"),r.a.createElement(k.a,{name:"gender",onChange:this.updateRootInfo,defaultValue:this.state.gender},r.a.createElement(O.a,{value:""},"  ",r.a.createElement("em",null,"None")," "),r.a.createElement(O.a,{value:"female"},"Female"),r.a.createElement(O.a,{value:"male"},"Male"),r.a.createElement(O.a,{value:"non-binary"},"NonBinary"),r.a.createElement(O.a,{value:"unknown"},"Unknown")))))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(x.a,{container:!0,spacing:2,direction:"row"},r.a.createElement(x.a,{item:!0},r.a.createElement(j.a,{label:"Birth Date",name:"birth",type:"date",InputLabelProps:{shrink:!0},onChange:this.updateRootInfo,defaultValue:this.state.birth})),r.a.createElement(x.a,{item:!0},r.a.createElement(j.a,{label:"Death Date",name:"death",type:"date",InputLabelProps:{shrink:!0},onChange:this.updateRootInfo,defaultValue:this.state.death})))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(j.a,Object(i.a)({id:"outlined-multiline-static",name:"moreinfo",label:"More Information",multiline:!0,rows:"6",defaultValue:"Add here...",variant:"outlined",style:{margin:8},fullWidth:!0,onChange:this.updateRootInfo},"defaultValue",this.state.moreinfo))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(x.a,{container:!0,direction:"column",alignItems:"center"},r.a.createElement(x.a,{item:!0},r.a.createElement("h3",null,"Add your documents (if any) here:")),r.a.createElement(x.a,{item:!0},e),r.a.createElement(x.a,{item:!0,style:{margin:8}},r.a.createElement(E.a,{size:"small","aria-label":"small outlined button group",color:"primary"},r.a.createElement(b.a,{onClick:this.addDocument,variant:"contained"},"Add New Doc"),r.a.createElement(b.a,{onClick:this.deleteLastDocument}," Delete Last Doc "))),r.a.createElement(x.a,{item:!0,style:{margin:8}},!this.state.isRoot&&!this.props.isUpdate&&r.a.createElement(I,{updateRelnForm:this.updateRelnForm,selectedName:this.props.selectedJson.name,selectedIsRoot:!!this.props.selectedJson.hasOwnProperty("root"),name:this.state.name})))),r.a.createElement(x.a,{item:!0},r.a.createElement(b.a,{onClick:this.create,variant:"contained",color:"secondary",size:"large",label:"Finish",style:{margin:8}},this.props.isUpdate?"Update":"Create"),!this.state.isRoot&&r.a.createElement(b.a,{onClick:this.props.back,variant:"outlined",color:"secondary",size:"large",label:"Finish",style:{margin:8}}," Cancel "),this.state.isRoot&&r.a.createElement(b.a,{onClick:this.props.close,variant:"outlined",color:"secondary",size:"large",label:"Finish",style:{margin:8}}," Cancel "))))}}]),t}(r.a.Component)),R=Object(g.e)(D),N=a(53),S=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).state={isRoot:!0},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(N.a,{trigger:r.a.createElement(b.a,{color:"secondary",variant:"contained"}," Add New Tree "),position:"right center",modal:!0},(function(t){return r.a.createElement("div",null,r.a.createElement("h1",null," Add your first person to the family tree! "),r.a.createElement("p",null," Your family tree will be idenitifed by this person. You can change this later. "),r.a.createElement(R,Object.assign({},e.state,{close:t.bind(e)})))}))}}]),t}(r.a.Component),T=a(56),J=a(193),_=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).getTreeRoots=Object(u.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/gettrees");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,a.setState({tree_roots:n.tree_roots}),console.log(a.tree_roots);case 8:case"end":return e.stop()}}),e)}))),a.updateTree=function(e){console.log(e),a.props.history.push({pathname:"/update",state:{family:e}})},a.state={tree_roots:[]},a.name=a.props.selectedJson,a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.getTreeRoots()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(x.a,{container:!0,spacing:3,justify:"center",direction:"column",style:{margin:8}},r.a.createElement(x.a,{item:!0},r.a.createElement(J.a,{maxWidth:"md"},r.a.createElement(T.a,{variant:"h2",align:"center"}," The Descendants Project "))),r.a.createElement(x.a,{item:!0},r.a.createElement(J.a,{maxWidth:"sm"},r.a.createElement(x.a,{container:!0,spacing:3,justify:"center"},r.a.createElement(x.a,{item:!0},r.a.createElement(T.a,{variant:"h5"}," Select Existing Tree ")),r.a.createElement(x.a,{item:!0,container:!0,spacing:1,justify:"center",alignItems:"center",style:{height:300,overflow:"auto"}},this.state.tree_roots.map((function(t){return r.a.createElement(x.a,{item:!0}," ",r.a.createElement(b.a,Object(i.a)({color:"secondary",onClick:function(){return e.updateTree(t)},variant:"outlined"},"color","primary")," ",t.name," ")," ")}))),r.a.createElement(x.a,{item:!0},r.a.createElement(S,null)))))))}}]),t}(r.a.Component),U=a(95),A=a(188),F=a(156),V=a(194),L=function(e){function t(e){return Object(d.a)(this,t),Object(p.a)(this,Object(h.a)(t).call(this,e))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(F.a,null,r.a.createElement(V.a,null,this.props.k+" : "," ",r.a.createElement("a",{href:this.props.val}," ",this.props.val," ")))}}]),t}(r.a.Component),W=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).state={isDocument:"documents"===a.props.k},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.k+" : "+this.props.val;if("documents"===this.props.k){e=[];for(var t=0;t<this.props.val.length;t++){var a=this.props.val[t].name,n=this.props.val[t].link;e.push(r.a.createElement(L,{k:a,val:n}))}}return r.a.createElement(F.a,null,r.a.createElement(V.a,null,this.state.isDocument&&r.a.createElement("div",null," Documents "),e))}}]),t}(r.a.Component),z=function(e){function t(e){return Object(d.a)(this,t),Object(p.a)(this,Object(h.a)(t).call(this,e))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){for(var e=[],t=0;t<this.props.selectedArr.length;t++){var a=this.props.selectedArr[t][0];if("name"!=a){var n=this.props.selectedArr[t][1];e.push(r.a.createElement(W,{k:a,val:n}))}}return r.a.createElement("div",null,r.a.createElement("h1",null,"Viewing ",this.props.selectedJson.name),r.a.createElement(A.a,{id:"viewNodeInfo"},e),r.a.createElement(b.a,{onClick:this.props.edit}," Edit "),r.a.createElement(b.a,{onClick:this.props.add}," Add Relative "))}}]),t}(r.a.Component),B=function(e){function t(e){return Object(d.a)(this,t),Object(p.a)(this,Object(h.a)(t).call(this,e))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(N.a,{trigger:r.a.createElement(x.a,{container:!0,justify:"center",alignItems:"center"},r.a.createElement(x.a,{item:!0},r.a.createElement(b.a,{variant:"contained",size:"large",style:{margin:8}}," Delete "))),position:"right center",modal:!0},(function(t){return r.a.createElement("div",null,r.a.createElement(T.a,{variant:"h6"}," Are you sure you want to delete this person from the tree? "),r.a.createElement(T.a,{variant:"body2"}," This will delete any people directly below this person in the tree, their spouse, and the data for all of those people."),r.a.createElement("div",{className:"actions"},r.a.createElement(b.a,{className:"button",onClick:function(){t()}}," Cancel "),r.a.createElement(b.a,{className:"button",variant:"outlined",color:"primary",onClick:function(){e.props.delete()}}," Confirm ")))}))}}]),t}(r.a.Component),P=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).updateSelectedNode=function(e){a.json[e.target.name]=e.target.value},a.submitUpdates=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/api/updatenode/person="+JSON.stringify(t),e.next=3,fetch(n);case 3:return r=e.sent,e.next=6,r.json();case 6:e.sent,a.props.back();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.deleteNode=Object(u.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(a.props.selectedJson.root),t="/api/deletenode/id="+a.props.selectedID,e.next=4,fetch(t);case 4:return n=e.sent,e.next=7,n.json();case 7:e.sent,1===a.props.selectedJson.root?a.props.history.push({pathname:"/"}):a.props.back(!0);case 9:case"end":return e.stop()}}),e)}))),a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",null," Edit "),r.a.createElement(R,{selectedJson:this.props.selectedJson,isRoot:!1,isUpdate:!0,updateNode:this.submitUpdates,back:this.props.back}),r.a.createElement(B,Object.assign({},this.state,{delete:this.deleteNode.bind(this)})))}}]),t}(r.a.Component),M=Object(g.e)(P),H=function(e){function t(e){return Object(d.a)(this,t),Object(p.a)(this,Object(h.a)(t).call(this,e))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("h1",null,this.props.message)}}]),t}(r.a.Component),Y={view:z,update:M,add:R,home:H},q=a(92),G=a.n(q),$=a(55),K=a(94),Q=(a(149),a(93)),X=a.n(Q);a(151);window.d3=K;var Z=function(e){function t(e){var a;Object(d.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).getTree=Object(u.a)(l.a.mark((function e(){var t,n,r=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 1==(!(r.length>0&&void 0!==r[0])||r[0])&&a.state.socket.emit("FetchTree",{session:a.state.session,tree_id:a.state.root_id}),e.next=4,fetch("/api/gettree/id="+a.state.root_id);case 4:return t=e.sent,e.next=7,t.json();case 7:n=e.sent,a.setState({root_name:n[0].name,tree:n}),a.drawTree();case 10:case"end":return e.stop()}}),e)}))),a.drawTree=function(){for(var e=document.getElementById("graph");e.lastChild;)e.removeChild(e.lastChild);var t=a.state.tree;X.a.init(t,{target:a.refs.tree,debug:!0,height:800,width:1200,callbacks:{nodeClick:a.chooseNode,nodeHeightSeperation:function(e,t){return 30}},margin:{top:0,right:0,bottom:0,left:0},nodeWidth:100,styles:{node:"node",linage:"linage",marriage:"marriage",text:"nodeText"}})},a.chooseNode=function(e,t,n){a.getNode(t),a.setState({display:"view"})},a.getNode=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/getnode/id="+t);case 2:return n=e.sent,e.next=5,n.json();case 5:r=e.sent,s=[],r.documents=JSON.parse(r.documents.replace(/\n|\r/g,"").replace(/'/g,'"')),Object.entries(r).forEach((function(e){var t=Object(U.a)(e,2),a=t[0],n=t[1];"id"!==a&&"root"!==a&&"depth"!==a&&s.push([a,n])})),a.setState({selectedArr:s,selectedID:t,selectedJson:r});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.changeRoot=function(e){a.state.root_id=e,a.back(!1,e)},a.edit=function(){a.setState({display:"update"})},a.back=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.state.selectedID;console.log(e),1==e?a.setState({selectedArr:[],selectedID:"",selectedJson:{},display:"home"}):(a.getNode(t),a.setState({display:"view"})),a.getTree()},a.add=function(){a.setState({display:"add"})};var n=new $.a;if("https:"===window.location.protocol)var r="wss://";else r="ws://";return console.log(r+window.location.hostname),a.state={session:n.get("SESSION_ID"),socket:G()(r+window.location.hostname),display:"home",root_name:e.location.state.family.name,root_id:e.location.state.family.id,tree:[],selectedID:"",selectedArr:[],selectedJson:{}},a.state.socket.on("RefreshTree",(function(e){e.tree_id===a.state.root_id&&a.state.session!==e.session&&(console.log("Another client is working on this tree"),a.getTree(!1))})),a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.getTree()}},{key:"render",value:function(){var e=Y[this.state.display];return r.a.createElement(J.a,null,r.a.createElement(v.a,{split:"vertical",defaultSize:400},r.a.createElement("div",{style:{maxHeight:"100%",overflow:"auto"}},r.a.createElement(e,Object.assign({},this.state,{isRoot:!1,edit:this.edit.bind(this),back:this.back.bind(this),add:this.add.bind(this),changeRoot:this.changeRoot.bind(this),message:"Click a person to view their information!"}))),r.a.createElement("div",null,r.a.createElement("p",{class:"text"}," ",this.state.root_name,"'s Family "),r.a.createElement("svg",{ref:"tree",id:"graph",width:1e3,height:700}))))}}]),t}(r.a.Component),ee=a(44);var te=function(){var e=new $.a,t=a(152);return e.set("SESSION_ID",t(),{path:"/"}),r.a.createElement("div",null,r.a.createElement(ee.a,null,r.a.createElement("div",null,r.a.createElement(g.a,{exact:!0,path:"/",component:_}),r.a.createElement(g.a,{path:"/update",component:Z}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(te,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[105,1,2]]]);
//# sourceMappingURL=main.ad7309d4.chunk.js.map